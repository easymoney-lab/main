# 微信小程序部署指南

## 📋 部署前检查清单

### 1. 代码检查
- [ ] 所有功能测试通过
- [ ] 没有控制台错误
- [ ] 调试模式已关闭（发布前）
- [ ] 代码注释清理（可选）

### 2. 配置检查
- [ ] AppID 配置正确
- [ ] 项目名称正确
- [ ] 版本号设置
- [ ] 小程序基本信息完整

### 3. 功能测试
- [ ] 添加行程功能正常
- [ ] 搜索功能正常
- [ ] 设置功能正常
- [ ] 数据存储正常
- [ ] GPS定位功能正常

## 🚀 部署步骤

### 第一步：关闭调试模式

在发布前，需要关闭调试模式以提升性能：

**修改 `app.js`：**
```javascript
isDebugMode() {
  return false; // 发布时改为 false
}
```

**修改 `utils/util.js`：**
```javascript
const DEBUG = false; // 发布时改为 false
```

### 第二步：配置 AppID

#### 方式1：使用测试号（仅用于开发测试）
- 在微信开发者工具中选择"测试号"
- 只能用于开发调试，无法正式发布

#### 方式2：注册小程序账号（正式发布必需）

1. **注册小程序账号**
   - 访问：https://mp.weixin.qq.com
   - 点击"立即注册" > 选择"小程序"
   - 按照流程完成注册（需要邮箱、营业执照等）

2. **获取 AppID**
   - 登录微信公众平台
   - 在"开发" > "开发管理" > "开发设置"中查看 AppID

3. **配置 AppID**
   - 在微信开发者工具中，点击右上角"详情"
   - 在"本地设置"中填写 AppID
   - 或在 `project.config.json` 中修改 `appid` 字段

### 第三步：完善小程序信息

在微信公众平台完善以下信息：

1. **基本信息**
   - 小程序名称：情侣行程记录（或自定义）
   - 小程序简介：用于情侣双方互相汇报行程并记录
   - 小程序头像：上传图标（建议 512x512px）
   - 小程序类目：选择合适类目（如：工具 > 效率）

2. **服务类目**
   - 根据小程序功能选择相应类目
   - 可能需要提供相关资质

### 第四步：上传代码

1. **在微信开发者工具中上传**
   - 点击工具栏"上传"按钮
   - 填写版本号（如：1.0.0）
   - 填写项目备注（如：初始版本）
   - 点击"上传"

2. **确认上传成功**
   - 上传成功后，代码会出现在微信公众平台
   - 登录 https://mp.weixin.qq.com
   - 进入"版本管理" > "开发版本"查看

### 第五步：提交审核

1. **在微信公众平台提交审核**
   - 登录微信公众平台
   - 进入"版本管理" > "开发版本"
   - 点击"提交审核"

2. **填写审核信息**
   - 选择类目
   - 填写标签（如：情侣、行程、记录）
   - 上传小程序页面截图（至少5张）
   - 填写版本描述

3. **等待审核**
   - 审核时间通常 1-7 个工作日
   - 可以在"版本管理"中查看审核状态

### 第六步：发布上线

1. **审核通过后发布**
   - 审核通过后，在"版本管理" > "审核版本"中
   - 点击"全量发布"
   - 小程序正式上线

2. **发布后操作**
   - 用户可以通过搜索小程序名称找到
   - 可以分享小程序码给用户
   - 可以设置小程序码样式

## 📱 发布后推广

### 1. 获取小程序码
- 在微信公众平台 > "设置" > "基本设置"
- 下载小程序码
- 可以分享给用户扫码使用

### 2. 分享小程序
- 在微信中分享小程序卡片
- 分享小程序码图片
- 通过公众号关联推广（如果有）

### 3. 设置关键词
- 在"推广" > "搜索优化"中设置关键词
- 提高小程序搜索排名

## ⚙️ 版本管理

### 开发版本
- 开发中的版本
- 可以随时上传新版本覆盖

### 审核版本
- 提交审核的版本
- 审核通过后可以发布

### 线上版本
- 用户正在使用的版本
- 发布新版本后会自动替换

## 🔧 常见问题

### Q: 必须注册小程序账号才能发布吗？
A: 是的，正式发布必须注册小程序账号并获取 AppID。测试号只能用于开发调试。

### Q: 审核不通过怎么办？
A: 查看审核反馈，根据要求修改后重新提交。

### Q: 可以修改已发布的小程序吗？
A: 可以，上传新版本并提交审核，审核通过后发布即可。

### Q: 小程序需要服务器吗？
A: 当前版本使用本地存储，不需要服务器。如需云端同步，可以接入微信云开发。

### Q: 如何更新小程序？
A: 修改代码后，上传新版本号，提交审核，审核通过后发布。

## 📝 发布前检查脚本

运行以下命令检查配置：

```bash
# 检查调试模式是否关闭
grep -n "return true" app.js utils/util.js | grep -i "debug\|DEBUG"

# 检查 AppID 配置
grep -n "appid" project.config.json
```

## 🎯 快速部署流程

1. ✅ 关闭调试模式
2. ✅ 配置 AppID（注册小程序账号）
3. ✅ 完善小程序信息
4. ✅ 上传代码
5. ✅ 提交审核
6. ✅ 发布上线

## 💡 建议

1. **首次发布**：建议先发布测试版本，邀请少量用户测试
2. **版本号**：遵循语义化版本（如：1.0.0, 1.1.0, 2.0.0）
3. **更新日志**：每次更新记录更新内容
4. **用户反馈**：收集用户反馈，持续改进

