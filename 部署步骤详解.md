# 微信小程序部署步骤详解

## 🎯 部署流程概览

```
开发完成 → 关闭调试 → 上传代码 → 提交审核 → 发布上线
```

## 📝 详细步骤

### 第一步：准备发布版本

#### 方法1：使用快速部署脚本（推荐）

```bash
cd "/Users/kd/微信小程序"
./快速部署.sh
```

脚本会自动：
- 备份当前配置
- 关闭调试模式
- 运行发布前检查

#### 方法2：手动操作

1. **关闭调试模式**

   编辑 `app.js`：
   ```javascript
   isDebugMode() {
     return false; // 改为 false
   }
   ```

   编辑 `utils/util.js`：
   ```javascript
   const DEBUG = false; // 改为 false
   ```

2. **运行检查**
   ```bash
   ./发布前检查.sh
   ```

### 第二步：在微信开发者工具中上传

1. **打开微信开发者工具**
   - 确保项目已正确打开
   - 确认 AppID 已配置

2. **点击上传按钮**
   - 工具栏点击"上传"按钮（或菜单：项目 > 上传）
   - 或使用快捷键（Mac: Cmd+Shift+U）

3. **填写上传信息**
   - **版本号**：如 `1.0.0`（遵循语义化版本）
   - **项目备注**：如 `初始版本 - 情侣行程记录功能`

4. **确认上传**
   - 点击"上传"按钮
   - 等待上传完成（会显示上传进度）

5. **上传成功提示**
   - 显示"上传成功"
   - 代码已上传到微信服务器

### 第三步：在微信公众平台提交审核

1. **登录微信公众平台**
   - 访问：https://mp.weixin.qq.com
   - 使用小程序管理员账号登录

2. **进入版本管理**
   - 左侧菜单：开发 > 版本管理
   - 查看"开发版本"，应该能看到刚上传的版本

3. **点击"提交审核"**
   - 在开发版本列表中，找到刚上传的版本
   - 点击右侧"提交审核"按钮

4. **填写审核信息**

   **基本信息：**
   - **类目**：选择合适的小程序类目
     - 建议选择：工具 > 效率
     - 或根据实际功能选择
   
   - **标签**：填写关键词（最多5个）
     - 例如：情侣、行程、记录、生活、工具
   
   - **小程序页面截图**：
     - 至少上传5张截图
     - 展示主要功能页面
     - 建议包含：首页、添加页面、详情页、设置页
   
   - **版本描述**：
     ```
     情侣行程记录小程序
     
     主要功能：
     - 双身份切换（我/TA）
     - 行程汇报和记录
     - GPS定位选择地点
     - 搜索和统计功能
     - 个性化设置
     ```

5. **提交审核**
   - 确认信息无误
   - 点击"提交审核"
   - 等待审核（通常1-7个工作日）

### 第四步：审核结果处理

#### 审核通过

1. **收到审核通过通知**
   - 微信会发送通知
   - 或在版本管理中查看状态变为"审核通过"

2. **发布上线**
   - 进入"版本管理" > "审核版本"
   - 点击"全量发布"
   - 确认发布
   - 小程序正式上线！

#### 审核不通过

1. **查看审核反馈**
   - 在版本管理中查看审核意见
   - 了解不通过的原因

2. **修改问题**
   - 根据反馈修改代码
   - 重新上传版本
   - 重新提交审核

### 第五步：发布后操作

1. **获取小程序码**
   - 设置 > 基本设置 > 小程序码
   - 下载小程序码图片
   - 可以分享给用户

2. **设置搜索关键词**
   - 推广 > 搜索优化
   - 添加搜索关键词
   - 提高搜索排名

3. **分享小程序**
   - 在微信中分享小程序卡片
   - 分享小程序码
   - 通过公众号关联（如果有）

## 🔄 版本更新流程

当需要更新小程序时：

1. **修改代码**
   - 在本地修改代码
   - 测试功能正常

2. **准备发布**
   - 运行 `./快速部署.sh`
   - 或手动关闭调试模式

3. **上传新版本**
   - 版本号递增（如：1.0.0 → 1.0.1）
   - 填写更新说明

4. **提交审核**
   - 填写版本更新描述
   - 说明新增功能或修复的问题

5. **发布更新**
   - 审核通过后发布
   - 用户会自动更新到新版本

## 📊 版本号规范

建议使用语义化版本号：

- **主版本号**：重大更新（如：1.0.0 → 2.0.0）
- **次版本号**：新功能（如：1.0.0 → 1.1.0）
- **修订号**：bug修复（如：1.0.0 → 1.0.1）

示例：
- `1.0.0` - 初始版本
- `1.1.0` - 添加GPS定位功能
- `1.1.1` - 修复定位bug
- `2.0.0` - 重大更新（如添加云端同步）

## ⚠️ 注意事项

1. **测试充分**
   - 发布前充分测试所有功能
   - 确保没有严重bug

2. **版本说明**
   - 每次上传都要填写清晰的版本说明
   - 帮助审核人员理解更新内容

3. **审核时间**
   - 首次审核可能需要较长时间
   - 后续更新审核通常较快

4. **备份代码**
   - 发布前备份代码
   - 保留各个版本的代码

5. **用户通知**
   - 重大更新可以通知用户
   - 说明新功能和改进

## 🎯 快速检查清单

发布前确认：

- [ ] 调试模式已关闭
- [ ] AppID 已正确配置
- [ ] 所有功能测试通过
- [ ] 没有控制台错误
- [ ] 版本号已设置
- [ ] 小程序信息已完善
- [ ] 已准备好页面截图
- [ ] 已准备好版本描述

## 💡 提示

1. **首次发布**：建议先邀请少量用户测试
2. **持续改进**：根据用户反馈持续优化
3. **版本管理**：保留各版本代码，方便回滚
4. **文档维护**：保持文档与代码同步更新

