# GPS定位功能说明

## ✨ 新增功能

在地点输入模块中添加了GPS定位选择功能，可以快速获取当前位置。

## 🎯 功能特点

1. **一键定位**：点击"定位"按钮快速获取当前位置
2. **地图选择**：打开地图，可以精确选择位置
3. **权限管理**：自动处理位置权限请求
4. **备用方案**：如果地图选择失败，自动使用GPS坐标
5. **手动输入**：仍支持手动输入地点

## 📱 使用方法

### 方法1：使用定位按钮（推荐）

1. 在"汇报"页面，找到"地点"输入框
2. 点击右侧的"📍 定位"按钮
3. 首次使用会请求位置权限，点击"允许"
4. 系统会打开地图，你可以：
   - 查看当前位置
   - 在地图上选择或搜索位置
   - 确认选择的位置
5. 选择后，地点名称会自动填入输入框

### 方法2：手动输入

- 直接在输入框中输入地点名称
- 可以手动修改定位获取的地点名称

## 🔐 权限说明

### 首次使用

1. 点击"定位"按钮时，会弹出权限请求
2. 选择"允许"以使用定位功能
3. 如果选择"拒绝"，可以在设置中重新开启

### 权限设置

如果之前拒绝了权限，可以：
1. 点击"定位"按钮
2. 在弹出的提示中选择"去设置"
3. 在系统设置中开启位置权限

## ⚠️ 注意事项

1. **定位精度**：定位精度取决于GPS信号强度，室内可能精度较低
2. **网络要求**：地图选择功能需要网络连接
3. **隐私保护**：位置信息仅存储在本地，不会上传到服务器
4. **电池消耗**：GPS定位会消耗一定电量

## 🛠️ 技术实现

- **主要API**：`wx.chooseLocation()` - 打开地图选择位置
- **备用API**：`wx.getLocation()` - 获取GPS坐标
- **权限API**：`wx.authorize()` - 请求位置权限

## 💡 使用技巧

1. **精确定位**：在地图上可以拖动选择精确位置
2. **搜索地点**：在地图界面可以搜索具体地点
3. **保存常用地点**：定位后可以手动修改为更简洁的名称
4. **离线使用**：如果网络不好，可以使用GPS坐标模式

## 🐛 常见问题

### Q: 定位按钮点击没反应？
A: 检查是否已授权位置权限，如果没有，会弹出授权提示。

### Q: 定位不准确？
A: 可以在打开的地图上手动调整位置，或搜索具体地点名称。

### Q: 显示"定位中..."一直加载？
A: 可能是网络问题或GPS信号弱，可以取消后手动输入地点。

### Q: 不想使用定位功能？
A: 可以直接在输入框中手动输入地点，定位功能是可选的。

## 📊 数据格式

- **地图选择**：保存地点名称（如："北京市朝阳区xxx"）
- **GPS坐标**：如果地图选择失败，保存坐标格式（如："纬度:39.123456, 经度:116.123456"）

